"""
åˆ†ç±»ï¼šç¦»æ•£å‹
å›å½’ï¼šè¿ç»­å‹

çº¿æ€§å›å½’ï¼š
çº¿æ€§å›å½’é€šè¿‡ä¸€ä¸ªæˆ–è€…å¤šä¸ªè‡ªå˜é‡ä¸å› å˜é‡ä¹‹é—´ä¹‹é—´è¿›è¡Œå»ºæ¨¡çš„å›å½’åˆ†æã€‚
å…¶ä¸­ç‰¹ç‚¹ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªç§°ä¸ºå›å½’ç³»æ•°çš„æ¨¡å‹å‚æ•°çš„çº¿æ€§ç»„åˆã€‚
ä¸€å…ƒçº¿æ€§å›å½’ï¼šæ¶‰åŠåˆ°çš„å˜é‡åªæœ‰ä¸€ä¸ª
å¤šå…ƒçº¿æ€§å›å½’ï¼šæ¶‰åŠåˆ°çš„å˜é‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Š

f(x) = âˆ‘(wi * xi) + b
wæƒé‡
båç½®é¡¹ï¼Œå¯ä»¥ç†è§£ä¸ºw0*1

é€šç”¨å…¬å¼ï¼šâ„(ğ‘¤)= w0 + w1*x1 + â€¦ = w^T(è½¬ç½®)*x
åˆ—çŸ©é˜µw = [[w0],[w1],[w2]],
x = [[1], [x1], [x2]]

çŸ©é˜µä¹˜æ³•numpy.muitiply(a, b)

æŸå¤±å‡½æ•°(è¯¯å·®å¤§å°)ï¼š
yiä¸ºç¬¬iä¸ªè®­ç»ƒæ ·æœ¬çš„çœŸæ˜¯åª
hw(xi)ä¸ºç¬¬iä¸ªè®­ç»ƒæ ·æœ¬ç‰¹å¾å€¼ç»„åˆé¢„æµ‹å‡½æ•°
æ€»æŸå¤±å®šä¹‰ï¼š
ğ½(ğœƒ)= ã€–ã€–(â„ã€—_ğ‘¤ (ğ‘¥ã€—_1) âˆ’ğ‘¦_1 )^2+ã€–ã€–(â„ã€—_ğ‘¤ (ğ‘¥ã€—_2) âˆ’ğ‘¦_2 )^2+â€¦+ã€–ã€–(â„ã€—_ğ‘¤ (ğ‘¥ã€—_ğ‘š) âˆ’ğ‘¦_ğ‘š )^2

             = âˆ‘_(ğ‘–=1)^ğ‘šâ–’ã€–(â„_ğ‘¤ (ğ‘¥_ğ‘– )âˆ’ğ‘¦_ğ‘– ã€— )^2
ç±»ä¼¼äºæ ‡å‡†å·®ä¸å¼€æ ¹å·
è¯¯å·®å¹³æ–¹å’Œåˆç§°æœ€å°äºŒä¹˜æ³•

å¦‚ä½•ä½¿æŸå¤±å‡½æ•°æœ€å°ï¼Œæ±‚æœ€ä¼˜åŒ–çš„wï¼š
1ã€æ­£è§„æ–¹ç¨‹(ç‰¹å¾æ•°é‡å¤šæ—¶æ±‚è§£é€Ÿåº¦æ…¢ï¼Œæ‰€ä»¥ä¸é€šç”¨)
w = (X^T*X)^(-1)*(X^T)*Y
Xç‰¹å¾å€¼çŸ©é˜µ
Yç›®æ ‡å€¼çŸ©é˜µ
æœ‰å‡ ä¸ªç‰¹å¾å°±æœ‰å‡ ä¸ªw
2ã€æ¢¯åº¦ä¸‹é™(é¢å¯¹è®­ç»ƒæ•°æ®è§„æ¨¡ååˆ†åºå¤§çš„ä»»åŠ¡)
æ²¿ç€è¿™ä¸ªæŸå¤±å‡½æ•°ä¸‹é™çš„æ–¹å‘æ‰¾ï¼Œæœ€åå°±èƒ½æ‰¾åˆ°å±±è°·çš„æœ€ä½ç‚¹ï¼Œç„¶åæ›´æ–°Wå€¼
å­¦ä¹ ç‡aè¶Šå¤§ï¼Œä¸‹é™å¾—è¶Šå¿«ã€‚

sklearn.linear_model.LinearRegression
æ­£è§„æ–¹ç¨‹
sklearn.linear_model.SGDRegressor
æ¢¯åº¦ä¸‹é™

å›å½’æ€§èƒ½è¯„ä¼°sklearn.metrics.mean_squared_error
å‡æ–¹è¯¯å·®(Mean Squared Error)MSE) è¯„ä»·æœºåˆ¶ï¼š
MSE = (1/m)*âˆ‘i=1~m (y^i-y^â€”)^2
y^ié¢„æµ‹å€¼
y^â€”çœŸå®å€¼
mean_squared_error(y_true,Â y_pred)
å‡æ–¹è¯¯å·®å›å½’æŸå¤±
y_true:çœŸå®å€¼
y_pred:é¢„æµ‹å€¼
return:æµ®ç‚¹æ•°ç»“æœ

çº¿æ€§å›å½’å™¨æ˜¯æœ€ä¸ºç®€å•ã€æ˜“ç”¨çš„å›å½’æ¨¡å‹ã€‚
ä»æŸç§ç¨‹åº¦ä¸Šé™åˆ¶äº†ä½¿ç”¨ï¼Œå°½ç®¡å¦‚æ­¤ï¼Œåœ¨ä¸çŸ¥é“ç‰¹å¾ä¹‹é—´å…³ç³»çš„å‰æä¸‹ï¼Œæˆ‘ä»¬ä»ç„¶ä½¿ç”¨çº¿æ€§å›å½’å™¨ä½œä¸ºå¤§å¤šæ•°ç³»ç»Ÿçš„é¦–è¦é€‰æ‹©ã€‚
å°è§„æ¨¡æ•°æ®ï¼šLinearRegression(ä¸èƒ½è§£å†³æ‹Ÿåˆé—®é¢˜)
å¤§è§„æ¨¡æ•°æ®ï¼šSGDRegressor


å®ä¾‹ï¼šæ³¢å£«é¡¿æˆ¿ä»·é¢„æµ‹
æ•°æ®æ¥æºï¼šfrom sklearn.datasets import load_boston

1ã€æ³¢å£«é¡¿åœ°åŒºæˆ¿ä»·æ•°æ®è·å–
2ã€æ³¢å£«é¡¿åœ°åŒºæˆ¿ä»·æ•°æ®åˆ†å‰²
3ã€è®­ç»ƒä¸æµ‹è¯•æ•°æ®æ ‡å‡†åŒ–å¤„ç†
4ã€ä½¿ç”¨æœ€ç®€å•çš„çº¿æ€§å›å½’æ¨¡å‹LinearRegressionå’Œæ¢¯åº¦ä¸‹é™ä¼°è®¡SGDRegressorå¯¹æˆ¿ä»·è¿›è¡Œé¢„æµ‹
5ã€ä½¿ç”¨å‡å€¼è¯¯å·®è¿›è¡Œæ€§èƒ½è¯„ä¼°

"""
from sklearn.datasets import load_boston
from sklearn.linear_model import LinearRegression, SGDRegressor
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import mean_squared_error


def mylinear():
    """
    çº¿æ€§å›å½’ç›´æ¥é¢„æµ‹æˆ¿ä»·
    :return: None
    """
    # è·å–æ•°æ®
    lb = load_boston()

    # åˆ†å‰²è®­ç»ƒé›†å’Œæµ‹è¯•é›†
    x_train, x_test, y_train, y_test = train_test_split(lb.data, lb.target, test_size=0.25)

    # è¿›è¡Œæ ‡å‡†åŒ–å¤„ç†
    # ç‰¹å¾å€¼å’Œç›®æ ‡å€¼éƒ½éœ€è¦è¿›è¡Œæ ‡å‡†åŒ–å¤„ç†ï¼Œå› ä¸ºç‰¹å¾å€¼å’Œç›®æ ‡å€¼ç‰¹è¯æ•°ä¸åŒï¼Œæ‰€ä»¥éœ€è¦å®ä¾‹åŒ–ä¸¤ä¸ªæ ‡å‡†åŒ–API
    std_x = StandardScaler()
    x_train = std_x.fit_transform(x_train)
    x_test = std_x.transform(x_test)

    # ç›®æ ‡å€¼
    std_y = StandardScaler()
    y_train = std_y.fit_transform(y_train.reshape(-1, 1))  # 0.19ç‰ˆæœ¬ä»¥åè¦æ±‚æ˜¯äºŒç»´ï¼Œä¸çŸ¥é“æ ·æœ¬æ•°ï¼Œæ‰€ä»¥-1ï¼Œä¸€ä¸ªç‰¹å¾æ‰€ä»¥1
    y_test = std_y.transform(y_test.reshape(-1, 1))

    # estimstoré¢„æµ‹
    # æ­£è§„æ–¹ç¨‹æ±‚è§£æ–¹å¼é¢„æµ‹ç»“æœ
    lr = LinearRegression()
    lr.fit(x_train, y_train)
    print("æ­£è§„æ–¹ç¨‹å›å½’ç³»æ•°ï¼š", lr.coef_)

    # é¢„æµ‹çš„æˆ¿ä»·
    y_predict = std_y.inverse_transform(lr.predict(x_test))
    print("æ­£è§„æ–¹ç¨‹æµ‹è¯•é›†é‡Œæ¯ä¸ªæˆ¿å­çš„é¢„æµ‹ä»·æ ¼ï¼š", y_predict)
    print("æ­£è§„æ–¹ç¨‹çš„å‡æ–¹è¯¯å·®ï¼š", mean_squared_error(std_y.inverse_transform(y_test), y_predict))

    # æ¢¯åº¦ä¸‹é™æ±‚è§£æ–¹å¼é¢„æµ‹ç»“æœ
    sgd = SGDRegressor()
    sgd.fit(x_train, y_train)
    print("æ¢¯åº¦ä¸‹é™å›å½’ç³»æ•°ï¼š", sgd.coef_)

    # é¢„æµ‹çš„æˆ¿ä»·
    y_sgd_predict = std_y.inverse_transform(sgd.predict(x_test))
    print("æ¢¯åº¦ä¸‹é™æµ‹è¯•é›†é‡Œæ¯ä¸ªæˆ¿å­çš„é¢„æµ‹ä»·æ ¼ï¼š", y_sgd_predict)
    print("æ¢¯åº¦ä¸‹é™çš„å‡å€¼è¯¯å·®ï¼š", mean_squared_error(std_y.inverse_transform(y_test), y_sgd_predict))

    return None


if __name__ == '__main__':
    mylinear()
